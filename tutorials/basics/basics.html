<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Basics</title>
        <style>
</style>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="basics">Basics</h1>
<h2 id="getting-started-with-d3js-and-sas-viya">Getting started with D3.js and SAS Viya</h2>
<p>In this article we're going to walk through how to build a simple bar chart in D3.js. We're going to use the <code>D3.csv</code> function to get a target format for our data. We're then going to look at SAS' example, pull out the refreshing code we need, and write a function to reformat SAS' data into the same format as <code>D3.csv</code>.</p>
<p>At the end we'll have a basic barchart that you can host and point SAS at.</p>
<p><em><strong>Note:</strong> this tutorial assumes a basic knowledge of HTML + JS. No knowledge of D3.js is assumed.</em></p>
<h2 id="building-a-chart-with-d3js">Building a chart with D3.js</h2>
<h3 id="setup">Setup</h3>
<p>First things first, build a simple HTML page, pulling in the latest version of D3.js from their website and adding an SVG canvas.</p>
<pre><code class="language-html"><div><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Simple barchart<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://d3js.org/d3.v6.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;920&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<p>You can open this, but it won't display anything.</p>
<p>From my understanding (limited), D3.js is an abstraction of drawing on a normal SVG canvas. So rather than having to specify every detail about the circle you're going to draw, you can use a <code>circle</code> function that abstracts the detail out. It also has some nice functions for processing CSV data that we'll make use of.</p>
<p>So next, make a <code>barchart.js</code> file and include it in the body of your HTML page:</p>
<pre><code class="language-html"><div>...
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;920&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;barchart.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
...
</div></code></pre>
<h3 id="barchart-script">Barchart script</h3>
<p>We'll go through building the <code>barchart.js</code> file in detail.</p>
<p>First, put your SVG canvas into a variable. Specify a <code>margin</code> variable that will apply some padding to our graph, and calculate the width and height that our final barchart will be.</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">var</span> svg = d3.select(<span class="hljs-string">&quot;svg&quot;</span>),
    margin = <span class="hljs-number">100</span>,
    width = svg.attr(<span class="hljs-string">&quot;width&quot;</span>) - margin ,
    height = svg.attr(<span class="hljs-string">&quot;height&quot;</span>) - margin;
</div></code></pre>
<p>Next, specify the scale we want to use for our X and Y axes. This is going to be a barchart with the bars on the X-axis, so we use <code>scaleBand</code> for the X-axis, with a padding of 0.4. This padding is the space between each bar.</p>
<p>The Y-axis will be numeric, so we use <code>scaleLinear</code>.</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">var</span> xScale = d3.scaleBand().range ([<span class="hljs-number">0</span>, width]).padding(<span class="hljs-number">0.4</span>),
    yScale = d3.scaleLinear().range([height, <span class="hljs-number">0</span>]);
</div></code></pre>
<p>We're then going to append a <code>g</code> or 'group' element to our canvas, and offset it to give us some margin.</p>
<p>It's much easier to put all our elements in a group and move the group, than it is to move all our elements individually.</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">var</span> g = svg.append(<span class="hljs-string">&quot;g&quot;</span>)
       .attr(<span class="hljs-string">&quot;transform&quot;</span>, <span class="hljs-string">&quot;translate(&quot;</span> + margin/<span class="hljs-number">2</span> + <span class="hljs-string">&quot;,&quot;</span> + margin/<span class="hljs-number">2</span> + <span class="hljs-string">&quot;)&quot;</span>);
</div></code></pre>
<p>We're now ready to pull in some data and start building the chart.</p>
<h3 id="pulling-in-data">Pulling in data</h3>
<p>Knowing nothing about what data D3 will like, let's pull in some using D3.js and have a look at it.</p>
<p>Thinking about our high-level design, we want to build a very basic barchart. What will our data look like?</p>
<p>We will need two columns. One of these will be a categorical variable, probably a string. The other will be some numerical value. For example:</p>
<table>
<thead>
<tr>
<th>id</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>10</td>
</tr>
<tr>
<td>2</td>
<td>11</td>
</tr>
<tr>
<td>3</td>
<td>8</td>
</tr>
<tr>
<td>4</td>
<td>9</td>
</tr>
<tr>
<td>5</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>D3 has a <code>csv</code> function that will load in data in the format that D3.js likes. Unfortunately the data has to be online somewhere. There's a CSV we can use in the Git repo for this tutorial.</p>
<p><code>d3.csv</code> returns a <code>Promise</code> object, which is basically saying, &quot;Trust me, when you need the data it'll be there.&quot;</p>
<p>We won't be using this for our SAS integration, so let's just use <code>console.log</code> to get a look at the data.</p>
<pre><code class="language-javascript"><div>d3.csv(<span class="hljs-string">&quot;https://raw.githubusercontent.com/hannah-scott/D3.js/main/tutorials/basics/data/basics.csv&quot;</span>)
    .then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
        <span class="hljs-built_in">console</span>.log(d);
});
</div></code></pre>
<p>You'll get a message like this in your browser developer tools:</p>
<pre><code class="language-javascript"><div>(<span class="hljs-number">5</span>) […]
<span class="hljs-number">0</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&quot;10&quot;</span> }
<span class="hljs-number">1</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&quot;11&quot;</span> }
<span class="hljs-number">2</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&quot;8&quot;</span> }
<span class="hljs-number">3</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&quot;9&quot;</span> }
<span class="hljs-number">4</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&quot;10&quot;</span> }
<span class="hljs-attr">columns</span>: <span class="hljs-built_in">Array</span> [ <span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;value&quot;</span> ]
<span class="hljs-attr">length</span>: <span class="hljs-number">5</span>
&lt;prototype&gt;: <span class="hljs-built_in">Array</span> []
</div></code></pre>
<p>So we can see that <code>D3.csv</code> returns an array of objects. Each object in the array is a single <em>row</em> of our data. Each row is stored as a dictionary, where the keys are column headers and the values are just the value for that column.</p>
<p>This is our target format. We want to write a function that takes in SAS' data and returns it in this format. Now we need to find out what format SAS sends data in.</p>
<h2 id="sas-data-reformatting">SAS data reformatting</h2>
<p><strong>INSERT INFORMATION ABOUT SAS EXAMPLE HERE</strong></p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">var</span> sampleData = {<span class="hljs-attr">data</span>:[
    [<span class="hljs-string">&quot;2000&quot;</span>, <span class="hljs-number">100</span>],
    [<span class="hljs-string">&quot;2001&quot;</span>, <span class="hljs-number">101</span>],
    [<span class="hljs-string">&quot;2002&quot;</span>, <span class="hljs-number">102</span>],
    [<span class="hljs-string">&quot;2003&quot;</span>, <span class="hljs-number">96</span>],
    [<span class="hljs-string">&quot;2004&quot;</span>, <span class="hljs-number">100</span>],
    [<span class="hljs-string">&quot;2005&quot;</span>, <span class="hljs-number">101</span>],
    [<span class="hljs-string">&quot;2006&quot;</span>, <span class="hljs-number">102</span>],
    [<span class="hljs-string">&quot;2007&quot;</span>, <span class="hljs-number">96</span>]
]};

<span class="hljs-keyword">var</span> sampleColumnInfo = [
    {<span class="hljs-attr">label</span>: <span class="hljs-string">&quot;year&quot;</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;string&quot;</span>},
    {<span class="hljs-attr">label</span>: <span class="hljs-string">&quot;value&quot;</span>, <span class="hljs-attr">type</span>:<span class="hljs-string">&quot;number&quot;</span>}
];
</div></code></pre>
<p>To reformat this data, we need to:</p>
<ol>
<li>Get our column names and data</li>
<li>For each row of data, create a dictionary mapping column names to values</li>
<li>Append each of these dictionaries to an array</li>
<li>Return the array</li>
</ol>
<pre><code class="language-javascript"><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatSASData</span>(<span class="hljs-params">c, d</span>) </span>{
    <span class="hljs-comment">// Create container array</span>
    <span class="hljs-keyword">var</span> arr = []

    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>; i &lt; d.data.length; i++) {
        <span class="hljs-keyword">var</span> row = d.data[i]
        <span class="hljs-keyword">var</span> row_dict = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>;

        <span class="hljs-comment">// Map column name to value</span>
        <span class="hljs-keyword">for</span> (j=<span class="hljs-number">0</span>; j &lt; row.length; j++) {
            row_dict[c[j].label] = row[j];
        }

        <span class="hljs-comment">// Append row to container array</span>
        arr.push(row_dict);
    }

    <span class="hljs-keyword">return</span> arr
}
</div></code></pre>
<p>We can now test this:</p>
<pre><code class="language-javascript"><div><span class="hljs-built_in">console</span>.log(formatSASData(sampleColumnInfo, sampleData));
</div></code></pre>
<pre><code class="language-javascript"><div>(<span class="hljs-number">8</span>) […]
<span class="hljs-number">0</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">year</span>: <span class="hljs-string">&quot;2000&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">100</span> }
<span class="hljs-number">1</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">year</span>: <span class="hljs-string">&quot;2001&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">101</span> }
<span class="hljs-number">2</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">year</span>: <span class="hljs-string">&quot;2002&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">102</span> }
<span class="hljs-number">3</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">year</span>: <span class="hljs-string">&quot;2003&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">96</span> }
<span class="hljs-number">4</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">year</span>: <span class="hljs-string">&quot;2004&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">100</span> }
<span class="hljs-number">5</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">year</span>: <span class="hljs-string">&quot;2005&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">101</span> }
<span class="hljs-number">6</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">year</span>: <span class="hljs-string">&quot;2006&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">102</span> }
<span class="hljs-number">7</span>: <span class="hljs-built_in">Object</span> { <span class="hljs-attr">year</span>: <span class="hljs-string">&quot;2007&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">96</span> }
<span class="hljs-attr">length</span>: <span class="hljs-number">8</span>
&lt;prototype&gt;: <span class="hljs-built_in">Array</span> []
</div></code></pre>
<p>Success! Let's build a chart!</p>
<h2 id="building-the-chart">Building the chart</h2>
<p>We're going to build our chart in the following steps:</p>
<ol>
<li>Teardown the old chart. This is helpful if we're applying a filter to our data in SAS Viya: we want to redraw the axes each time, not leave the old ones on the screen</li>
<li>Scale our axes to the data</li>
<li>Draw the X and Y axes</li>
<li>Draw the bars at the right height</li>
</ol>
<p>We're going to do this all in a function.</p>
<p>First, set up a function and define some label variables for readability.</p>
<pre><code class="language-javascript"><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawBarchart</span>(<span class="hljs-params">columnInfo, data</span>) </span>{
    <span class="hljs-keyword">var</span> xLabel = columnInfo[<span class="hljs-number">0</span>].label,
        yLabel = columnInfo[<span class="hljs-number">1</span>].label;
</div></code></pre>
<p>Next we're going to tear down the old chart, add a new group and scale our X and Y axes. Our Y axis will start at 0. If you wanted to change this, you can just tweak the first value in the <code>domain</code> function.</p>
<pre><code class="language-javascript"><div>    svg.selectAll(<span class="hljs-string">&#x27;g&#x27;</span>).exit().remove();

    <span class="hljs-keyword">var</span> g = svg.append(<span class="hljs-string">&quot;g&quot;</span>)
        .attr(<span class="hljs-string">&quot;transform&quot;</span>, <span class="hljs-string">&quot;translate(&quot;</span> + margin/<span class="hljs-number">2</span> + <span class="hljs-string">&quot;,&quot;</span> + margin/<span class="hljs-number">2</span> + <span class="hljs-string">&quot;)&quot;</span>);

    xScale.domain(data.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
        <span class="hljs-keyword">return</span> d[xLabel];
    }));
    yScale.domain([
        <span class="hljs-number">0</span>,
        d3.max(data, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{<span class="hljs-keyword">return</span> d[yLabel];})
    ]);
</div></code></pre>
<p>Now we'll draw our X and Y axes:</p>
<pre><code class="language-javascript"><div>    <span class="hljs-comment">// Draw axes</span>
    g.append(<span class="hljs-string">&quot;g&quot;</span>)
    .attr(<span class="hljs-string">&quot;transform&quot;</span>, <span class="hljs-string">&quot;translate(&quot;</span> + <span class="hljs-number">0</span> + <span class="hljs-string">&quot;,&quot;</span> + height + <span class="hljs-string">&quot;)&quot;</span>)
    .call(d3.axisBottom(xScale).tickFormat(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>)</span>{
        <span class="hljs-keyword">return</span> d;
        }).ticks(<span class="hljs-number">10</span>))
        .enter()
        .append(<span class="hljs-string">&quot;text&quot;</span>)
        .attr(<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-number">6</span>)
        .attr(<span class="hljs-string">&quot;dx&quot;</span>, <span class="hljs-string">&quot;0.71em&quot;</span>)
        .attr(<span class="hljs-string">&quot;text-anchor&quot;</span>, <span class="hljs-string">&quot;end&quot;</span>)
        .text(xLabel);

    g.append(<span class="hljs-string">&quot;g&quot;</span>)
    .call(d3.axisLeft(yScale).tickFormat(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>)</span>{
        <span class="hljs-keyword">return</span> d;
        }).ticks(<span class="hljs-number">10</span>))
        .enter()
        .append(<span class="hljs-string">&quot;text&quot;</span>)
        .attr(<span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-number">6</span>)
        .attr(<span class="hljs-string">&quot;dy&quot;</span>, <span class="hljs-string">&quot;0.71em&quot;</span>)
        .attr(<span class="hljs-string">&quot;text-anchor&quot;</span>, <span class="hljs-string">&quot;end&quot;</span>)
        .text(yLabel);
</div></code></pre>
<p>Finally, draw our bars and close off the function:</p>
<pre><code class="language-javascript"><div>    <span class="hljs-comment">// Draw bars</span>
    g.selectAll(<span class="hljs-string">&quot;.bar&quot;</span>)
        .data(data)
        .enter().append(<span class="hljs-string">&quot;rect&quot;</span>)
        .attr(<span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;bar&quot;</span>)
        .attr(<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> xScale(d[xLabel]); })
        .attr(<span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> yScale(d[yLabel]); })
        .attr(<span class="hljs-string">&quot;width&quot;</span>, xScale.bandwidth())
        .attr(<span class="hljs-string">&quot;height&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> height - yScale(d[yLabel]); });
};
</div></code></pre>
<p>Let's test this out: manually set the datasets at the bottom of your <code>barchart.js</code> file and open up the HTML file in a browser.</p>
<pre><code class="language-javascript"><div>results = sampleData;
columnInfo = sampleColumnInfo;
data = formatSASData(columnInfo, results);
drawChart(columnInfo, data);
</div></code></pre>
<p>You should get something like this:</p>
<p><img src="file:///c:\Users\es129\Documents\Code\D3.js\tutorials\basics\images\barchart.png" alt="&quot;Barchart&quot;"></p>
<p><em><strong>Note:</strong> The code up to this point is included in the code directory.</em></p>
<h2 id="sas-listener">SAS listener</h2>
<p>This final bit is lifted from SAS' example code again. We want to add a function that loads SAS data when it's supplied, and a listener to call that function.</p>
<p>First, the function to load SAS data.</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">var</span> self = <span class="hljs-built_in">this</span>;

<span class="hljs-comment">// Retrieve data and begin processing</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onMessage</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-comment">// Check if event has happened and if data was sent</span>
    <span class="hljs-keyword">if</span> (evt &amp;&amp; evt.data) {
        <span class="hljs-keyword">var</span> results = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> columnInfo = <span class="hljs-literal">null</span>;

        self.resultName = evt.data.resultName;

        <span class="hljs-comment">// If there is any data, then load it</span>
        <span class="hljs-keyword">if</span> (evt.data.availableRowCount &gt;= <span class="hljs-number">0</span>) {
            results = evt.data;
            columnInfo = evt.data.columns;
        }
        <span class="hljs-comment">// Otherwise, load the sample data</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (evt.data.availableRowCount == <span class="hljs-number">-1</span>) {
            results = sampleData;
            columnInfo = sampleColumnInfo;
        }

        <span class="hljs-comment">// If there is loaded data, format it and draw the barchart</span>
        <span class="hljs-keyword">if</span>(results) {
            data = formatSASData(columnInfo, results);
            drawChart(columnInfo, data);
        }
    }
}
</div></code></pre>
<p>And the listener.</p>
<pre><code class="language-javascript"><div><span class="hljs-comment">// Fetch data and run process</span>
<span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.addEventListener) {
    <span class="hljs-comment">// For standards-compliant web browsers</span>
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&quot;message&quot;</span>, onMessage, <span class="hljs-literal">false</span>);
} <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">window</span>.attachEvent(<span class="hljs-string">&quot;onmessage&quot;</span>, onMessage);
}
</div></code></pre>
<p>Comment out the manually set datasets, and you're ready to point SAS at the chart!</p>

    </body>
    </html>